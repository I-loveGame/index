<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Введите свой Steam ID</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        input {
            padding: 10px;
            margin-bottom: 20px;
            width: 200px;
        }
        button {
            padding: 10px 20px;
            margin-top: 10px;
        }
        .user-info {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        .user-info img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <h1>Введите ваш Steam ID</h1>
    <input type="text" id="steamId" placeholder="Steam ID (17 цифр)">
    <button id="submitButton">Отправить</button>
    
    <div class="user-info" id="userInfo">
        <h2>Это ваш аккаунт?</h2>
        <img id="avatar" src="" alt="Avatar">
        <p id="realName"></p>
        <p id="nickname"></p>
        <button id="confirmButton">Подтвердить</button>
    </div>

    <script>
        document.getElementById('submitButton').onclick = function() {
            const steamId = document.getElementById('steamId').value;
            if (steamId.length === 17 && /^\d+$/.test(steamId)) {
                fetch(`https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=F8A10F215FECA2977A762232DEA544F3&steamids=${steamId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Сеть не в порядке или API недоступно');
                    }
                    return response.json();
                })
                .then(data => {
                    const player = data.response.players[0];
                    if (player) {
                        document.getElementById('avatar').src = player.avatar;
                        document.getElementById('realName').innerText = `Реальное имя: ${player.realname || 'Не указано'}`;
                        document.getElementById('nickname').innerText = `Никнейм: ${player.personaname}`;
                        document.getElementById('userInfo').style.display = 'block';
                    } else {
                        alert('Не удалось получить информацию о пользователе.');
                    }
                })
                .catch(error => {
                    console.error('Ошибка:', error);
                    alert('Произошла ошибка при получении данных. Попробуйте позже. ' + error.message);
                });
            } else {
                alert('Пожалуйста, введите корректный Steam ID (17 цифр).');
            }
        };

        document.getElementById('confirmButton').onclick = function() {
            const steamId = document.getElementById('steamId').value;
            window.Telegram.WebApp.sendData(steamId);
        };
    </script>
</body>
</html>